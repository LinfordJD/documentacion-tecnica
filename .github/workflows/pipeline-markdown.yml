on:
  pull_request:
    branches: [ "main" ]
    paths:
      - '**.md'
      - '.github/workflows/**'

  workflow_dispatch:

jobs:
  markdown-lint:
    name: Lint Markdown Files
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18.x'
          cache: 'npm'
          
      - name: Install markdownlint-cli
        run: npm install -g markdownlint-cli
          
      - name: Create markdownlint configuration
        run: |
          cat > .markdownlint.json << 'EOF'
          {
            "default": true,
            "MD013": {
              "line_length": 120
            },
            "MD024": {
              "allow_different_nesting": true
            },
            "MD025": false,
            "MD033": {
              "allowed_elements": ["br", "details", "summary"]
            },
            "MD041": false
          }
          EOF
          
      - name: Run markdownlint
        run: |
          echo "Running markdownlint on all Markdown files..."
          markdownlint "**/*.md" \
            --ignore node_modules/ \
            --ignore .git/ \
            --ignore dist/ \
            --ignore build/ \
            --ignore coverage/
